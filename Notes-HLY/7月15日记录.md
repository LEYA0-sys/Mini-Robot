# API接口调研

> [!IMPORTANT]
>
> 本文API构建参考[suhuail/api-mcp](https://github.com/suhuail/api-mcp)，给出了需要用到的参数，只是当构建MCP的时候需要填入具体的值。腾讯云产品部署好以后我在后续的文件中会更新此文档，给出具体的参数值。
>
> 密钥获取链接：[访问密钥 - 控制台](https://console.cloud.tencent.com/cam/capi)本项目统一使用一套密钥，一个账号。密钥是必须的



## 容器服务会用到的API接口

### 查询容器实例日志

> [!NOTE]
>
> 这个的意义不大，它返回的是秒级别的日志

> [!TIP]
>
> 使用场景:不适用于每日自动触发的播报，适用于用户交互情景，用户可能存在这一需求如询问小智：
>
> “小智请问n秒前的日志状态/现在的日志状态”



#### 参考链接

[容器服务 查询容器实例日志_腾讯云](https://cloud.tencent.com/document/api/457/61661)

#### API接口-MCP服务

```
{
  "api_name": "腾讯云容器实例-查询容器日志",
  "api_url": "https://tke.tencentcloudapi.com/",
  "method": "POST",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "header",
  "required_headers": {
    "X-TC-Action": "DescribeEksContainerInstanceLog",
    "X-TC-Version": "2018-05-25",
    "X-TC-Region": "string",
    "Content-Type": "application/json"
  },
  "request_format": {
    "EksCiId": "string",
    "ContainerName": "string",
    "Tail": "number",
    "StartTime": "string",
    "Previous": "boolean",
    "SinceSeconds": "number",
    "LimitBytes": "number"
  },
  "response_format": {
    "LogContent": "string",
    "RequestId": "string"
  },
  "description": "查询容器实例日志"
}
```

不同字段对应的信息不同，如下，在部署好集群环境以后我会进行修改。

![image-20250715002144159](./7%E6%9C%8815%E6%97%A5%E8%AE%B0%E5%BD%95.assets/image-20250715002144159-1752510106872-1.png)

#### 返回内容

返回日志内容

### 重启容器服务

> [!TIP]
>
> 使用场景：运维，有点类似于“刷新的功能”。
>
> 用户可以给小智输入指令，被动触发
>
> 或者写入程序，遇到无法解决的日志报错，小智自动选择重启容器

#### 参考链接

[容器服务 重启容器实例_腾讯云](https://cloud.tencent.com/document/api/457/61660)

#### API接口-MCP服务

```
{
  "api_name": "腾讯云容器实例-重启容器实例",
  "api_url": "https://tke.tencentcloudapi.com/",
  "method": "POST",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "header",
  "required_headers": {
    "X-TC-Action": "RestartEKSContainerInstances",
    "X-TC-Version": "2018-05-25",
    "X-TC-Region": "string",
    "Content-Type": "application/json"
  },
  "request_format": {
    "EksCiIds": ["string"]
  },
  "response_format": {
    "RequestId": "string"
  },
  "description": "重启指定的腾讯云弹性容器实例"
}
```

返回内容：唯一请求ID

### 查看集群状态

> [!TIP]
>
> 场景：用于运维/播报

#### 参考链接

[容器服务 查看集群状态列表_腾讯云](https://cloud.tencent.com/document/api/457/68727)

#### API-MCP服务

```
{
  "api_name": "腾讯云容器服务-查询集群状态",
  "api_url": "https://tke.tencentcloudapi.com/",
  "method": "POST",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "header",
  "required_headers": {
    "X-TC-Action": "DescribeClusterStatus",
    "X-TC-Version": "2018-05-25",
    "X-TC-Region": "string",
    "Content-Type": "application/json"
  },
  "request_format": {
    "ClusterIds": ["string"] ##集群ID列表
  },
  "response_format": {
    "RequestId": "string",
    "ClusterStatusSet": [
      {
        "ClusterId": "string",
        "ClusterState": "string",
        "ClusterInstanceState": "string",
        "ClusterStatus": "string"
      }
    ]
  },
  "description": "查询腾讯云容器服务集群状态信息"
}
```



返回内容：

![image-20250715013934276](./7%E6%9C%8815%E6%97%A5%E8%AE%B0%E5%BD%95.assets/image-20250715013934276-1752514775877-3.png)



### 查看TKE集群列表

> [!TIP]
>
> 使用场景：运维，有点类似于“刷新的功能”。
>
> 用户可以给小智输入指令，被动触发
>
> 或者写入程序，遇到无法解决的日志报错，小智自动选择重启容器



#### 参考链接

[容器服务 查询TKE集群列表_腾讯云](https://cloud.tencent.com/document/api/457/31862)

#### API-MCP接口

```
{
  "api_name": "腾讯云容器服务-查询集群列表",
  "api_url": "https://tke.tencentcloudapi.com/",
  "method": "POST",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "header",
  "required_headers": {
    "X-TC-Action": "DescribeClusters",
    "X-TC-Version": "2018-05-25",
    "X-TC-Region": "string",
    "Content-Type": "application/json"
  },
  "request_format": {
    "ClusterIds": ["string"],
    "Filters": [
      {
        "Name": "string",
        "Values": ["string"]
      }
    ],
    "Offset": "integer",
    "Limit": "integer"
  },
  "response_format": {
    "RequestId": "string",
    "TotalCount": "integer",
    "Clusters": [
      {
        "ClusterId": "string",
        "ClusterName": "string",
        "ClusterDescription": "string",
        "ClusterVersion": "string",
        "ClusterOs": "string",
        "ClusterType": "string",
        "ClusterNetworkSettings": {
          "ClusterCIDR": "string",
          "MaxNodePodNum": "integer",
          "MaxClusterServiceNum": "integer"
        },
        "ClusterStatus": "string",
        "CreatedTime": "string"
      }
    ]
  },
  "description": "查询腾讯云容器服务集群列表信息"
}
```

## 日志服务

> [!IMPORTANT]
>
> 这一块已经有MCP服务了，参考链接：[腾讯云日志服务CLS - 腾讯云](https://cloud.tencent.com/developer/mcp/server/11710)
>
> [云监控日志MCP服务 - 腾讯云](https://cloud.tencent.com/developer/mcp/server/11005)
>
> 



### 获取日志主题列表

> [!TIP]
>
> 使用场景：用户主动交互



#### 参考链接

[日志服务 获取日志主题列表_腾讯云](https://cloud.tencent.com/document/api/614/56454)

#### API-MCP接口

```
{
  "api_name": "腾讯云日志服务-查询日志主题",
  "api_url": "https://cls.tencentcloudapi.com/",
  "method": "POST",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "header",
  "required_headers": {
    "X-TC-Action": "DescribeTopics",
    "X-TC-Version": "2020-10-16",
    "X-TC-Region": "string",
    "Content-Type": "application/json"
  },
  "request_format": {
    "Filters": [
      {
        "Name": "string",
        "Values": ["string"]
      }
    ],
    "Offset": "integer",
    "Limit": "integer"
  },
  "response_format": {
    "RequestId": "string",
    "Topics": [
      {
        "TopicId": "string",
        "TopicName": "string",
        "LogsetId": "string",
        "PartitionCount": "integer",
        "Index": "boolean",
        "AssumerName": "string",
        "CreateTime": "string",
        "Status": "boolean",
        "Tags": [
          {
            "Key": "string",
            "Value": "string"
          }
        ],
        "AutoSplit": "boolean",
        "MaxSplitPartitions": "integer",
        "StorageType": "string"
      }
    ],
    "TotalCount": "integer"
  },
  "description": "查询腾讯云日志服务主题列表信息"
}
```

![image-20250715134757679](./7%E6%9C%8815%E6%97%A5%E8%AE%B0%E5%BD%95.assets/image-20250715134757679-1752558478930-1.png)

## 人脸识别

### 人脸验证

> [!TIP]
>
> 使用场景：小智主动触发此功能

#### 参考链接

[人脸识别 人脸验证_腾讯云](https://cloud.tencent.com/document/product/867/44983)

#### API-MCP服务

```
{
  "api_name": "腾讯云人脸核身-人脸验证",
  "api_url": "https://iai.tencentcloudapi.com/",
  "method": "POST",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "header",
  "required_headers": {
    "X-TC-Action": "VerifyFace",
    "X-TC-Version": "2020-03-03",
    "X-TC-Region": "string",
    "Content-Type": "application/json"
  },
  "request_format": {
    "PersonId": "string",
    "Image": "string",
    "Url": "string",
    "QualityControl": "integer",
    "NeedRotateDetection": "integer"
  },
  "response_format": {
    "RequestId": "string",
    "Score": "float",
    "IsMatch": "boolean",
    "FaceModelVersion": "string",
    "QualityScore": "float"
  },
  "description": "腾讯云人脸核身服务，验证指定人员ID与人脸图片的匹配度"
}
```

### 人脸搜索+人员搜索

> [!TIP]
>
> 使用场景：小智主动触发
>
> 本质上两个服务没有区别，但是人员搜索更准确

#### 参考链接

[人脸识别 人脸搜索_腾讯云](https://cloud.tencent.com/document/product/867/44994)

#### API-MCP

```
{
  "api_name": "腾讯云人脸识别-人脸搜索",
  "api_url": "https://iai.tencentcloudapi.com/",
  "method": "GET",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "query",
  "required_headers": {
    "Content-Type": "application/json"
  },
  "required_query_params": {
    "Action": "SearchFaces",
    "Version": "2020-03-03",
    "Region": "string"
  },
  "request_format": {
    "Image": "string",
    "Url": "string",
    "MaxFaceNum": "integer",
    "MinFaceSize": "integer",
    "MaxPersonNum": "integer",
    "GroupIds": ["string"],
    "QualityControl": "integer",
    "NeedRotateDetection": "integer"
  },
  "response_format": {
    "RequestId": "string",
    "Results": [
      {
        "GroupId": "string",
        "PersonId": "string",
        "FaceId": "string",
        "Score": "float",
        "PersonName": "string",
        "Gender": "integer",
        "PersonGroupInfos": [
          {
            "GroupId": "string",
            "PersonExDescriptions": ["string"]
          }
        ]
      }
    ],
    "FaceNum": "integer",
    "FaceModelVersion": "string"
  },
  "description": "在指定人员库中搜索与给定图片最相似的人脸"
}
```

```
{
  "api_name": "腾讯云人脸识别-人员搜索",
  "api_url": "https://iai.tencentcloudapi.com/",
  "method": "GET",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "query",
  "required_headers": {
    "Content-Type": "application/json"
  },
  "required_query_params": {
    "Action": "SearchPersons",
    "Version": "2020-03-03",
    "Region": "string"
  },
  "request_format": {
    "Image": "string",
    "Url": "string",
    "MaxFaceNum": "integer",
    "MinFaceSize": "integer",
    "MaxPersonNum": "integer",
    "GroupIds": ["string"],
    "QualityControl": "integer",
    "NeedRotateDetection": "integer",
    "NeedPersonInfo": "integer"
  },
  "response_format": {
    "RequestId": "string",
    "Results": [
      {
        "GroupId": "string",
        "PersonId": "string",
        "Score": "float",
        "PersonName": "string",
        "Gender": "integer",
        "PersonExDescriptionInfos": [
          {
            "PersonExDescriptionIndex": "integer",
            "PersonExDescription": "string"
          }
        ],
        "FaceId": "string",
        "FaceRect": {
          "X": "integer",
          "Y": "integer",
          "Width": "integer",
          "Height": "integer"
        }
      }
    ],
    "PersonNum": "integer",
    "FaceModelVersion": "string"
  },
  "description": "在指定人员库中搜索与给定图片最相似的人员"
}
```

### 添加人脸

> [!TIP]
>
> 使用场景：用户要求添加新的人脸图片

#### 参考链接

[人脸识别 增加人脸_腾讯云](https://cloud.tencent.com/document/product/867/45016)

#### API-MCP

```
{
  "api_name": "腾讯云人脸识别-创建人脸",
  "api_url": "https://iai.tencentcloudapi.com/",
  "method": "GET",
  "auth_type": "TC3-HMAC-SHA256",
  "key_location": "query",
  "required_headers": {
    "Content-Type": "application/json"
  },
  "required_query_params": {
    "Action": "CreateFace",
    "Version": "2020-03-03",
    "Region": "string"
  },
  "request_format": {
    "PersonId": "string",
    "Images": ["string"],
    "Urls": ["string"],
    "FaceMatchThreshold": "float",
    "QualityControl": "integer",
    "NeedRotateDetection": "integer",
    "UniquePersonControl": "integer"
  },
  "response_format": {
    "RequestId": "string",
    "SucFaceNum": "integer",
    "SucFaceIds": ["string"],
    "RetCode": ["integer"],
    "SucIndexes": ["integer"],
    "FailIndexes": ["integer"]
  },
  "description": "向指定人员ID添加人脸图片"
}
```

